-- EMPERORxZON-HUB v3.2 | النسخة النهائية المدمجة

local TweenService = game:GetService("TweenService")
local RS = game:GetService("RunService")
local Players = game:GetService("Players")
local UIS = game:GetService("UserInputService")
local pl = Players.LocalPlayer
local char = pl.Character or pl.CharacterAdded:Wait()
local hrp = char:WaitForChild("HumanoidRootPart")

-- ======= عرض المطور قبل القائمة =======
local introGui = Instance.new("ScreenGui", game.CoreGui)
introGui.Name = "EMPEROR_Intro"
introGui.ZIndexBehavior = Enum.ZIndexBehavior.Global

local introLabel = Instance.new("TextLabel", introGui)
introLabel.Size = UDim2.new(0.5,0,0.15,0)  -- أصغر
introLabel.Position = UDim2.new(0.5, -introLabel.Size.X.Offset/2, 0.5, -introLabel.Size.Y.Offset/2)
introLabel.Text = "- المطور أبو الحسن - حسين - .1._h -"
introLabel.BackgroundTransparency = 1
introLabel.TextScaled = true
introLabel.Font = Enum.Font.Antique
introLabel.TextStrokeTransparency = 0.7
introLabel.ZIndex = 10

-- Rainbow للألوان
RS.RenderStepped:Connect(function()
    local t = tick()*0.5
    introLabel.TextColor3 = Color3.fromHSV(t%1,1,1)
end)

task.delay(5, function()
    local info = TweenInfo.new(1.5, Enum.EasingStyle.Sine, Enum.EasingDirection.Out)
    TweenService:Create(introLabel, info, {TextTransparency=1}):Play()
    task.wait(1.5)
    introGui:Destroy()

    -- ======= القائمة الرئيسية بعد العرض =======
    local sg = Instance.new("ScreenGui", game.CoreGui)
    sg.Name = "EMPERORxZON-HUB"
    sg.ZIndexBehavior = Enum.ZIndexBehavior.Global

    -- Main Frame
    local screenSize = workspace.CurrentCamera.ViewportSize
    local isMobile = UIS.TouchEnabled and not UIS.KeyboardEnabled
    local mainWidth = isMobile and math.min(450, screenSize.X-50) or math.min(700, screenSize.X-50)
    local mainHeight = isMobile and math.min(300, screenSize.Y-50) or math.min(450, screenSize.Y-50)

    local mainFrame = Instance.new("Frame", sg)
    mainFrame.Size = UDim2.new(0, mainWidth, 0, mainHeight)
    mainFrame.Position = UDim2.new(0.5, -mainWidth/2, 0.5, -mainHeight/2)
    mainFrame.BackgroundColor3 = Color3.fromRGB(30,30,30)
    mainFrame.BorderSizePixel = 0
    mainFrame.ZIndex = 1

    -- Sidebar و ContentFrame
    local sidebarWidth = math.clamp(mainWidth*0.2, 120, 180)
    local sideBar = Instance.new("Frame", mainFrame)
    sideBar.Size = UDim2.new(0, sidebarWidth, 1, 0)
    sideBar.Position = UDim2.new(0,0,0,0)
    sideBar.BackgroundColor3 = Color3.fromRGB(20,20,20)
    sideBar.BorderSizePixel = 0

    local contentFrame = Instance.new("Frame", mainFrame)
    contentFrame.Size = UDim2.new(1, -sidebarWidth, 1, 0)
    contentFrame.Position = UDim2.new(0, sidebarWidth, 0, 0)
    contentFrame.BackgroundColor3 = Color3.fromRGB(40,40,40)
    contentFrame.BorderSizePixel = 0

    -- Lightning يمين الشاشة مع وميض وصوت
    local lightningImg = Instance.new("ImageLabel", sg)
    lightningImg.Size = UDim2.new(0,100,0,100)
    lightningImg.AnchorPoint = Vector2.new(0.5,0.5)
    lightningImg.Position = UDim2.new(1,-80,0.5,0)
    lightningImg.BackgroundTransparency = 1
    lightningImg.Image = "rbxassetid://15126724634" -- ⚡ صورة البرق
    lightningImg.ImageColor3 = Color3.fromRGB(255,255,0)
    lightningImg.ZIndex = 10
    lightningImg.ImageTransparency = 1 -- البداية مخفية

    local lightningSound = Instance.new("Sound", lightningImg)
    lightningSound.SoundId = "rbxassetid://9118821926" -- صوت برق
    lightningSound.Volume = 1

    task.spawn(function()
        while true do
            task.wait(math.random(2,5))
            for i = 1,3 do
                lightningImg.ImageTransparency = 0
                lightningSound:Play()
                task.wait(0.1)
                lightningImg.ImageTransparency = 1
                task.wait(0.1)
            end
            lightningImg.ImageTransparency = 1
        end
    end)

    -- زر فتح/اغلاق القائمة
    local toggleBtn = Instance.new("TextButton", sg)
    toggleBtn.Size = UDim2.new(0,50,0,50)
    toggleBtn.Position = UDim2.new(1,-70,0.5,-25)
    toggleBtn.Text = "✖"
    toggleBtn.BackgroundColor3 = Color3.fromRGB(0,0,0)
    toggleBtn.TextColor3 = Color3.new(1,1,1)
    toggleBtn.TextScaled = true

    local menuOpen = true
    toggleBtn.MouseButton1Click:Connect(function()
        local goal = {}
        if menuOpen then
            goal.Position = UDim2.new(1,0,0.5,-mainHeight/2)
            toggleBtn.Text = "≡"
        else
            goal.Position = UDim2.new(0.5,-mainWidth/2,0.5,-mainHeight/2)
            toggleBtn.Text = "✖"
        end
        menuOpen = not menuOpen
        TweenService:Create(mainFrame, TweenInfo.new(0.7, Enum.EasingStyle.Quad, Enum.EasingDirection.Out), goal):Play()
    end)

    -- دوال Tabs وزر سكربت
    local function createTab(name, callback)
        local btn = Instance.new("TextButton", sideBar)
        btn.Size = UDim2.new(1,0,0,35)
        btn.Position = UDim2.new(0,0,0,(#sideBar:GetChildren()-1)*40)
        btn.Text = name
        btn.TextColor3 = Color3.new(1,1,1)
        btn.BackgroundColor3 = Color3.fromRGB(30,30,30)
        btn.BorderSizePixel = 0
        btn.MouseButton1Click:Connect(function()
            for _,child in pairs(contentFrame:GetChildren()) do
                child:Destroy()
            end
            callback()
        end)
    end

    local function addScriptButton(parent, name, url, y)
        local btn = Instance.new("TextButton", parent)
        btn.Size = UDim2.new(1,-20,0,30)
        btn.Position = UDim2.new(0,10,0,y)
        btn.Text = name
        btn.TextColor3 = Color3.new(1,1,1)
        btn.BackgroundColor3 = Color3.fromRGB(60,60,60)
        btn.BorderSizePixel = 0
        btn.MouseButton1Click:Connect(function()
            setclipboard(url)
            loadstring(game:HttpGet(url))()
        end)
    end

    -- ===== Tabs كاملة =====
    createTab("ماب بيوت", function()
        addScriptButton(contentFrame, "سكربت ماب بيوت", "https://rawscripts.net/raw/Brookhaven-RP-NetroZHub-49812", 20)
        addScriptButton(contentFrame, "سكربت مارتن العراقي", "https://rawscripts.net/raw/Brookhaven-RP-MARTIN-IRAQ-31476", 60)
        addScriptButton(contentFrame, "سكربت S7 ماب بيوت", "https://rawscripts.net/raw/Brookhaven-RP-S7-hub-30753", 100)
        addScriptButton(contentFrame, "سكربت اسطوري", "https://rawscripts.net/raw/Brookhaven-RP-K0-41546", 140)
        addScriptButton(contentFrame, "سكربت ماب بيوت تخريب OPP", "https://rawscripts.net/raw/Universal-Script-SH-HUB-44927", 180)
        addScriptButton(contentFrame, "سكربت سايكو اسطوري", "https://rawscripts.net/raw/Brookhaven-RP-Siko-hub-48511", 220)
    end)

    createTab("بلوكس فروت", function()
        addScriptButton(contentFrame, "سكربت بلوكس فروت", "https://zuwz.me/Ls-Zee-Hub", 20)
    end)

    createTab("ماب سرقة", function()
        addScriptButton(contentFrame, "سكربت ماب سرقة اسطوري - RTX", "https://raw.githubusercontent.com/RTX261/RTXTOP1/refs/heads/main/RTX", 20)
    end)

    createTab("ماب مزرعة", function()
        addScriptButton(contentFrame, "سكربت ماب مزرعه سبيد هوب", "https://raw.githubusercontent.com/AhmadV99/Speed-Hub-X/main/Speed%20Hub%20X.lua", 20)
        addScriptButton(contentFrame, "سكربت ماب مزرعه نو لاغ", "https://raw.githubusercontent.com/NoLagHubID/No-LagHUB/refs/heads/main/LoaderV1.lua", 60)
    end)

    createTab("اخرى", function()
        addScriptButton(contentFrame, "سكربت VR7", "https://raw.githubusercontent.com/VR7ss/OMK/refs/heads/main/VR7-ON-TOP", 20)
        addScriptButton(contentFrame, "سكربت مضاد رهيب و غيره", "https://rawscripts.net/raw/Universal-Script-JanHub-32893", 60)
        addScriptButton(contentFrame, "سكربت نسخ ادمن-مابات ادمن فقط! 🔥", "https://pastebin.com/raw/67zRS6vS", 100)
    end)

    -- تبويب ديسكورد مع نسخ الرابط الجديد
    createTab("ديسكورد", function()
        local serverBtn = Instance.new("TextButton", contentFrame)
        serverBtn.Size = UDim2.new(1,-20,0,40)
        serverBtn.Position = UDim2.new(0,10,0,20)
        serverBtn.Text = "سيرفرنا - https://discord.gg/wYQyuh48t4  | اضغط للنسخ"
        serverBtn.TextColor3 = Color3.fromRGB(0,255,0)
        serverBtn.BackgroundColor3 = Color3.fromRGB(50,50,50)
        serverBtn.BorderSizePixel = 0
        serverBtn.TextScaled = true
        serverBtn.MouseButton1Click:Connect(function()
            setclipboard("سيرفرنا - https://discord.gg/wYQyuh48t4")
        end)

        local partnerBtn = Instance.new("TextButton", contentFrame)
        partnerBtn.Size = UDim2.new(1,-20,0,40)
        partnerBtn.Position = UDim2.new(0,10,0,70)
        partnerBtn.Text = "سيرفر الشراكة - https://discord.gg/4GVbdjkT  | اضغط للنسخ"
        partnerBtn.TextColor3 = Color3.fromRGB(0,255,0)
        partnerBtn.BackgroundColor3 = Color3.fromRGB(50,50,50)
        partnerBtn.BorderSizePixel = 0
        partnerBtn.TextScaled = true
        partnerBtn.MouseButton1Click:Connect(function()
            setclipboard("سيرفر الشراكة - https://discord.gg/4GVbdjkT")
        end)
    end)

    -- Rainbow Colors للقائمة
    RS.RenderStepped:Connect(function()
        local t = tick()*0.2
        mainFrame.BackgroundColor3 = Color3.fromHSV(t%1,1,1)
        sideBar.BackgroundColor3 = Color3.fromHSV((t+0.2)%1,1,1)
        toggleBtn.BackgroundColor3 = Color3.fromHSV((t+0.4)%1,1,1)
    end)

    -- سحب القائمة بالماوس/اللمس
    do
        local dragging = false
        local dragStart = Vector2.new()
        local startPos = mainFrame.Position

        mainFrame.InputBegan:Connect(function(input)
            if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
                dragging = true
                dragStart = input.Position
                startPos = mainFrame.Position
                input.Changed:Connect(function()
                    if input.UserInputState == Enum.UserInputState.End then
                        dragging = false
                    end
                end)
            end
        end)

        mainFrame.InputChanged:Connect(function(input)
            if dragging and (input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch) then
                local delta = input.Position - dragStart
                mainFrame.Position = UDim2.new(0, startPos.X.Offset + delta.X, 0, startPos.Y.Offset + delta.Y)
            end
        end)
    end
end)
